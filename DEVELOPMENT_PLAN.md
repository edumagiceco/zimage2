# Z-Image 기반 마케팅 이미지 생성 플랫폼 개발 계획

## 1. 프로젝트 개요

### 1.1 목표
Z-Image 모델을 활용하여 마케팅 부서에서 쉽게 사용할 수 있는 웹 기반 이미지 생성 플랫폼 구축

### 1.2 핵심 가치
- **속도**: Z-Image-Turbo의 1초 이하 추론으로 빠른 이미지 생성
- **품질**: 오픈소스 최고 수준의 포토리얼리스틱 이미지
- **접근성**: 비개발자도 쉽게 사용 가능한 웹 인터페이스
- **효율성**: 마케팅 워크플로우 최적화

---

## 2. 시스템 아키텍처

```
┌─────────────────────────────────────────────────────────────────┐
│                        Frontend (Next.js)                        │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────────────┐ │
│  │  이미지   │  │  갤러리  │  │  템플릿  │  │  사용자 관리     │ │
│  │  생성 UI  │  │  관리    │  │  라이브러리│  │  (로그인/권한)  │ │
│  └──────────┘  └──────────┘  └──────────┘  └──────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                     Backend API (FastAPI)                        │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────────────┐ │
│  │  이미지   │  │  작업    │  │  템플릿  │  │  사용자 인증     │ │
│  │  생성 API │  │  큐 관리 │  │  관리 API│  │  API             │ │
│  └──────────┘  └──────────┘  └──────────┘  └──────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
                              │
              ┌───────────────┼───────────────┐
              ▼               ▼               ▼
┌──────────────────┐  ┌──────────────┐  ┌──────────────────┐
│   Z-Image GPU    │  │   Database   │  │   File Storage   │
│   Worker         │  │   (PostgreSQL)│  │   (S3/MinIO)     │
│   (Celery)       │  │              │  │                  │
└──────────────────┘  └──────────────┘  └──────────────────┘
```

---

## 3. 기술 스택

### 3.1 Frontend
| 구분 | 기술 | 선정 사유 |
|------|------|-----------|
| 프레임워크 | Next.js 14 (App Router) | SSR/SSG 지원, React 기반 |
| 스타일링 | Tailwind CSS | 빠른 UI 개발, 반응형 지원 |
| 상태관리 | Zustand | 가볍고 직관적 |
| API 통신 | TanStack Query | 캐싱 및 비동기 상태 관리 |
| UI 컴포넌트 | shadcn/ui | 커스터마이징 가능한 고품질 컴포넌트 |

### 3.2 Backend
| 구분 | 기술 | 선정 사유 |
|------|------|-----------|
| API 서버 | FastAPI | 비동기 지원, 자동 문서화, Python 생태계 |
| 작업 큐 | Celery + Redis | 비동기 이미지 생성 작업 처리 |
| 인증 | JWT + OAuth2 | 사내 SSO 연동 가능 |
| ORM | SQLAlchemy | 성숙한 Python ORM |

### 3.3 AI/ML
| 구분 | 기술 | 선정 사유 |
|------|------|-----------|
| 모델 | Z-Image-Turbo (6B) | 1초 이하 추론, 16GB VRAM 지원 |
| 프레임워크 | Hugging Face Diffusers | Z-Image 공식 지원 |
| 최적화 | PyTorch 2.0 + compile | 추론 속도 최적화 |

### 3.4 인프라
| 구분 | 기술 | 선정 사유 |
|------|------|-----------|
| 컨테이너 | Docker + Docker Compose | 개발/배포 일관성 |
| GPU 서버 | NVIDIA GPU (16GB+ VRAM) | Z-Image 최소 요구사항 |
| 파일 저장소 | MinIO (자체 호스팅) / AWS S3 | 생성 이미지 저장 |
| DB | PostgreSQL | 안정성, 확장성 |
| 캐시/큐 | Redis | Celery 브로커 + 캐싱 |

---

## 4. 주요 기능 명세

### 4.1 이미지 생성 (핵심 기능)

#### 4.1.1 텍스트-투-이미지
```
기능: 텍스트 프롬프트로 이미지 생성
입력:
  - 프롬프트 (한글/영어 지원)
  - 네거티브 프롬프트
  - 이미지 크기 (512x512 ~ 1024x1024)
  - 생성 개수 (1~4장)
  - 시드값 (재현성)
출력:
  - 생성된 이미지 URL
  - 생성 메타데이터
```

#### 4.1.2 프롬프트 어시스턴트
```
기능: 마케팅 콘텐츠에 최적화된 프롬프트 제안
- 업종별 템플릿 (이커머스, SNS, 배너 등)
- 스타일 프리셋 (미니멀, 럭셔리, 캐주얼 등)
- 프롬프트 자동 향상 기능
```

#### 4.1.3 이미지 편집 (Z-Image-Edit 출시 후)
```
기능: 기존 이미지 수정
- 자연어 기반 편집
- 배경 변경
- 객체 추가/제거
- 스타일 변환
```

### 4.2 갤러리 및 자산 관리

```
기능:
- 생성 이미지 히스토리 조회
- 폴더/태그 기반 정리
- 즐겨찾기
- 다운로드 (PNG/JPG/WebP)
- 공유 링크 생성
- 검색 (프롬프트, 날짜, 태그)
```

### 4.3 템플릿 라이브러리

```
기능:
- 마케팅 용도별 프리셋 템플릿
  - SNS 포스트 (Instagram, Facebook, Twitter)
  - 배너 광고 (리더보드, 스카이스크래퍼)
  - 이커머스 상품 이미지
  - 이메일 마케팅 헤더
- 커스텀 템플릿 저장
- 팀 내 템플릿 공유
```

### 4.4 팀 협업

```
기능:
- 팀 워크스페이스
- 이미지 공유 및 코멘트
- 프로젝트별 폴더 관리
- 승인 워크플로우 (선택적)
```

### 4.5 관리자 기능

```
기능:
- 사용자 관리 (추가/삭제/권한)
- 사용량 통계 대시보드
- API 사용량 모니터링
- 시스템 상태 모니터링
```

---

## 5. 개발 단계별 계획

### Phase 1: MVP (최소 기능 제품)

#### 목표
핵심 이미지 생성 기능이 작동하는 최소 제품

#### 작업 항목

**1.1 인프라 구축**
- [ ] Docker 환경 구성
- [ ] PostgreSQL, Redis 설정
- [ ] MinIO 파일 저장소 구성
- [ ] GPU 서버 환경 설정

**1.2 Z-Image 모델 통합**
- [ ] Z-Image-Turbo 모델 다운로드 및 설치
- [ ] Hugging Face Diffusers 파이프라인 설정
- [ ] 추론 최적화 (torch.compile)
- [ ] 기본 이미지 생성 테스트

**1.3 Backend API 개발**
- [ ] FastAPI 프로젝트 구조 설정
- [ ] 이미지 생성 API 엔드포인트
- [ ] Celery 작업 큐 설정
- [ ] 파일 업로드/다운로드 API
- [ ] 기본 에러 핸들링

**1.4 Frontend 개발**
- [ ] Next.js 프로젝트 설정
- [ ] 이미지 생성 페이지 UI
- [ ] 프롬프트 입력 컴포넌트
- [ ] 이미지 미리보기/다운로드
- [ ] 생성 히스토리 (로컬)

**1.5 테스트 및 배포**
- [ ] API 단위 테스트
- [ ] E2E 테스트 (Playwright)
- [ ] 스테이징 환경 배포

---

### Phase 2: 사용자 관리 및 갤러리

#### 목표
사용자 인증 및 생성 이미지 관리 기능

#### 작업 항목

**2.1 인증 시스템**
- [ ] JWT 기반 인증 구현
- [ ] 로그인/로그아웃 UI
- [ ] 사내 SSO 연동 (선택적)
- [ ] 권한 관리 (일반/관리자)

**2.2 갤러리 기능**
- [ ] 이미지 저장 및 메타데이터 DB 모델
- [ ] 갤러리 페이지 UI
- [ ] 검색 및 필터링
- [ ] 폴더/태그 관리
- [ ] 즐겨찾기

**2.3 다운로드 및 공유**
- [ ] 다중 포맷 다운로드 (PNG/JPG/WebP)
- [ ] 공유 링크 생성
- [ ] 일괄 다운로드

---

### Phase 3: 템플릿 및 프롬프트 어시스턴트

#### 목표
마케팅 워크플로우 최적화

#### 작업 항목

**3.1 템플릿 시스템**
- [ ] 템플릿 DB 모델 설계
- [ ] 기본 템플릿 제작 (10종 이상)
- [ ] 템플릿 라이브러리 UI
- [ ] 커스텀 템플릿 저장

**3.2 프롬프트 어시스턴트**
- [ ] 스타일 프리셋 구현
- [ ] 업종별 키워드 제안
- [ ] 프롬프트 자동 향상 (LLM 연동 선택적)

**3.3 이미지 크기 프리셋**
- [ ] SNS 플랫폼별 크기 프리셋
- [ ] 광고 배너 크기 프리셋
- [ ] 커스텀 크기 저장

---

### Phase 4: 팀 협업 및 관리

#### 목표
팀 단위 사용 및 관리 기능

#### 작업 항목

**4.1 팀 워크스페이스**
- [ ] 팀/조직 데이터 모델
- [ ] 팀 생성 및 멤버 관리
- [ ] 팀 내 이미지 공유
- [ ] 프로젝트 폴더

**4.2 관리자 대시보드**
- [ ] 사용량 통계
- [ ] 사용자 관리 UI
- [ ] 시스템 모니터링

**4.3 고급 기능**
- [ ] 이미지 편집 기능 (Z-Image-Edit 출시 시)
- [ ] API 제공 (외부 시스템 연동)
- [ ] 워크플로우 자동화 (Webhook)

---

## 6. 데이터베이스 설계

### 6.1 ERD (Entity Relationship Diagram)

```
┌──────────────┐       ┌──────────────┐       ┌──────────────┐
│    users     │       │    teams     │       │  team_members│
├──────────────┤       ├──────────────┤       ├──────────────┤
│ id (PK)      │       │ id (PK)      │       │ id (PK)      │
│ email        │◄──────│ owner_id(FK) │       │ team_id (FK) │
│ password_hash│       │ name         │       │ user_id (FK) │
│ name         │       │ created_at   │       │ role         │
│ role         │       └──────────────┘       │ joined_at    │
│ created_at   │                              └──────────────┘
└──────────────┘
        │
        │ 1:N
        ▼
┌──────────────┐       ┌──────────────┐       ┌──────────────┐
│   images     │       │    folders   │       │ image_tags   │
├──────────────┤       ├──────────────┤       ├──────────────┤
│ id (PK)      │       │ id (PK)      │       │ id (PK)      │
│ user_id (FK) │       │ user_id (FK) │       │ image_id(FK) │
│ folder_id(FK)│◄──────│ name         │       │ tag_id (FK)  │
│ prompt       │       │ parent_id    │       └──────────────┘
│ neg_prompt   │       │ created_at   │              │
│ file_url     │       └──────────────┘              │
│ width        │                                     ▼
│ height       │                              ┌──────────────┐
│ seed         │                              │    tags      │
│ is_favorite  │                              ├──────────────┤
│ created_at   │                              │ id (PK)      │
└──────────────┘                              │ name         │
                                              │ user_id (FK) │
┌──────────────┐                              └──────────────┘
│  templates   │
├──────────────┤
│ id (PK)      │
│ name         │
│ category     │
│ prompt       │
│ settings     │
│ is_public    │
│ user_id (FK) │
│ created_at   │
└──────────────┘
```

---

## 7. API 설계

### 7.1 이미지 생성

```
POST /api/v1/images/generate
Request:
{
  "prompt": "현대적인 사무실에서 노트북을 사용하는 비즈니스맨",
  "negative_prompt": "blurry, low quality",
  "width": 1024,
  "height": 1024,
  "num_images": 2,
  "seed": null
}

Response:
{
  "task_id": "uuid",
  "status": "processing",
  "estimated_time": 2.5
}
```

### 7.2 작업 상태 조회

```
GET /api/v1/tasks/{task_id}
Response:
{
  "task_id": "uuid",
  "status": "completed",
  "images": [
    {
      "id": "uuid",
      "url": "https://...",
      "thumbnail_url": "https://...",
      "prompt": "...",
      "width": 1024,
      "height": 1024,
      "seed": 12345
    }
  ]
}
```

### 7.3 갤러리 조회

```
GET /api/v1/images?page=1&limit=20&folder_id=uuid&tag=마케팅
Response:
{
  "images": [...],
  "total": 150,
  "page": 1,
  "limit": 20
}
```

---

## 8. UI/UX 와이어프레임

### 8.1 메인 생성 화면

```
┌─────────────────────────────────────────────────────────────────┐
│  [Logo]  이미지 생성  │  갤러리  │  템플릿  │      [사용자]    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                                                         │   │
│  │                    프롬프트 입력                        │   │
│  │  "여름 휴가 컨셉의 밝고 화사한 SNS 광고 이미지..."     │   │
│  │                                                         │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────────────┐  │
│  │ 이미지 크기  │  │ 생성 개수    │  │ 고급 설정 ▼         │  │
│  │ [1024x1024▼] │  │ [2장 ▼]     │  │ 네거티브 프롬프트    │  │
│  └──────────────┘  └──────────────┘  │ 시드값               │  │
│                                      └──────────────────────┘  │
│                                                                 │
│               ┌──────────────────────────┐                     │
│               │      ✨ 이미지 생성      │                     │
│               └──────────────────────────┘                     │
│                                                                 │
│  ─────────────────────────────────────────────────────────────  │
│                                                                 │
│   생성 결과                                                     │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐           │
│  │         │  │         │  │         │  │         │           │
│  │  IMG 1  │  │  IMG 2  │  │  IMG 3  │  │  IMG 4  │           │
│  │         │  │         │  │         │  │         │           │
│  │ [⬇][♡] │  │ [⬇][♡] │  │ [⬇][♡] │  │ [⬇][♡] │           │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘           │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 8.2 갤러리 화면

```
┌─────────────────────────────────────────────────────────────────┐
│  [Logo]  이미지 생성  │  갤러리  │  템플릿  │      [사용자]    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌────────────────┐  ┌─────────────────────────────────────┐   │
│  │   📁 폴더     │  │  🔍 검색...          [필터▼][정렬▼] │   │
│  │   ─────────   │  └─────────────────────────────────────┘   │
│  │   📂 전체     │                                             │
│  │   📁 SNS광고  │   ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐         │
│  │   📁 배너     │   │     │ │     │ │     │ │     │         │
│  │   📁 이벤트   │   │ IMG │ │ IMG │ │ IMG │ │ IMG │         │
│  │   ─────────   │   │     │ │     │ │     │ │     │         │
│  │   🏷️ 태그    │   └─────┘ └─────┘ └─────┘ └─────┘         │
│  │   #여름       │                                             │
│  │   #프로모션   │   ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐         │
│  │   #신제품     │   │     │ │     │ │     │ │     │         │
│  │               │   │ IMG │ │ IMG │ │ IMG │ │ IMG │         │
│  │               │   │     │ │     │ │     │ │     │         │
│  └────────────────┘   └─────┘ └─────┘ └─────┘ └─────┘         │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 9. 하드웨어 요구사항

### 9.1 GPU 서버 (이미지 생성용)

| 구성 | 최소 사양 | 권장 사양 |
|------|----------|----------|
| GPU | NVIDIA RTX 4090 (24GB) | NVIDIA A100 (40GB) |
| CPU | 8코어 이상 | 16코어 이상 |
| RAM | 32GB | 64GB |
| Storage | 500GB SSD | 1TB NVMe SSD |
| 동시 처리 | 1~2건 | 4~8건 |

### 9.2 API/Web 서버

| 구성 | 최소 사양 | 권장 사양 |
|------|----------|----------|
| CPU | 4코어 | 8코어 |
| RAM | 8GB | 16GB |
| Storage | 100GB SSD | 200GB SSD |

### 9.3 파일 저장소

| 사용자 수 | 예상 저장 용량/월 |
|----------|------------------|
| 10명 | ~50GB |
| 50명 | ~250GB |
| 100명 | ~500GB |

---

## 10. 보안 고려사항

### 10.1 인증 및 인가
- JWT 토큰 기반 인증 (액세스/리프레시 토큰)
- HTTPS 필수 적용
- API Rate Limiting
- CORS 설정

### 10.2 데이터 보안
- 비밀번호 해싱 (bcrypt)
- 민감 정보 암호화
- SQL Injection 방지 (ORM 사용)
- XSS 방지 (입력값 검증)

### 10.3 인프라 보안
- 내부 네트워크 배포 (VPN 필요)
- 방화벽 설정
- 정기 보안 업데이트
- 로그 모니터링

---

## 11. 모니터링 및 운영

### 11.1 모니터링 항목
- GPU 사용률 및 메모리
- API 응답 시간 및 에러율
- 작업 큐 대기 시간
- 저장소 사용량

### 11.2 로깅
- 구조화된 JSON 로깅
- 로그 수준별 분리 (INFO, WARN, ERROR)
- 로그 보관 정책 (30일)

### 11.3 알림
- 서버 다운 알림
- GPU 에러 알림
- 저장소 용량 경고

---

## 12. 프로젝트 디렉토리 구조

```
zimage-platform/
├── frontend/                    # Next.js 프론트엔드
│   ├── app/                     # App Router 페이지
│   │   ├── (auth)/              # 인증 관련 페이지
│   │   ├── generate/            # 이미지 생성 페이지
│   │   ├── gallery/             # 갤러리 페이지
│   │   └── templates/           # 템플릿 페이지
│   ├── components/              # React 컴포넌트
│   │   ├── ui/                  # 기본 UI 컴포넌트
│   │   └── features/            # 기능별 컴포넌트
│   ├── lib/                     # 유틸리티
│   └── stores/                  # Zustand 스토어
│
├── backend/                     # FastAPI 백엔드
│   ├── app/
│   │   ├── api/                 # API 라우터
│   │   │   └── v1/
│   │   │       ├── images.py
│   │   │       ├── auth.py
│   │   │       └── templates.py
│   │   ├── core/                # 설정, 보안
│   │   ├── models/              # SQLAlchemy 모델
│   │   ├── schemas/             # Pydantic 스키마
│   │   ├── services/            # 비즈니스 로직
│   │   └── workers/             # Celery 태스크
│   ├── tests/                   # 테스트
│   └── alembic/                 # DB 마이그레이션
│
├── ml/                          # ML 관련
│   ├── models/                  # 모델 가중치
│   └── scripts/                 # 추론 스크립트
│
├── docker/                      # Docker 설정
│   ├── frontend.Dockerfile
│   ├── backend.Dockerfile
│   └── worker.Dockerfile
│
├── docker-compose.yml           # 로컬 개발 환경
├── docker-compose.prod.yml      # 프로덕션 환경
└── README.md
```

---

## 13. 리스크 및 대응 방안

| 리스크 | 영향도 | 대응 방안 |
|--------|--------|----------|
| GPU 서버 부족으로 대기 시간 증가 | 높음 | 큐 시스템 도입, 우선순위 설정, GPU 서버 증설 계획 |
| Z-Image 모델 업데이트 | 중간 | 모듈화된 ML 서비스 설계, 버전 관리 |
| 저장 용량 급증 | 중간 | 이미지 압축, 보관 정책 수립, 자동 정리 |
| 사용자 급증 | 중간 | 수평 확장 가능한 아키텍처, 로드밸런서 |

---

## 14. 성공 지표 (KPI)

| 지표 | 목표 |
|------|------|
| 이미지 생성 시간 | 3초 이내 |
| 시스템 가용성 | 99% 이상 |
| 일일 활성 사용자 (DAU) | 마케팅팀 80% 이상 |
| 사용자 만족도 | 4.0/5.0 이상 |
| 월간 생성 이미지 수 | 1,000장 이상 |

---

## 15. 참고 자료

- [Z-Image GitHub](https://github.com/Tongyi-MAI/Z-Image)
- [Z-Image Hugging Face](https://huggingface.co/Tongyi-MAI/Z-Image-Turbo)
- [Hugging Face Diffusers](https://huggingface.co/docs/diffusers)
- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [Next.js Documentation](https://nextjs.org/docs)
